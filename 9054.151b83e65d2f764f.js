"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9054],{9054:(X,_,c)=>{c.r(_),c.d(_,{Tab3PageModule:()=>B});var g=c(4742),m=c(177),p=c(4341),v=c(1307),u=c(7791),M=c(467);class P{constructor(a,o,t,i,s,r,l){this._id=a,this.username=o,this.password=t,this.firstName=i,this.lastName=s,this.createdAt=r,this.updatedAt=l}}var e=c(4438),C=c(3656),b=c(2652),O=c(529);const T=["content"],I=["chatInput"];function w(n,a){1&n&&(e.j41(0,"div"),e.EFF(1," pending "),e.nrm(2,"ion-icon",21),e.k0s())}function x(n,a){1&n&&(e.j41(0,"div"),e.EFF(1," sent "),e.nrm(2,"ion-icon",22),e.k0s())}function k(n,a){if(1&n&&e.DNE(0,x,3,0,"div",20),2&n){e.XpG();const o=e.sdS(5),t=e.XpG().$implicit;e.Y8G("ngIf","sent"===t.status)("ngIfElse",o)}}function S(n,a){1&n&&(e.j41(0,"div"),e.EFF(1," seen "),e.nrm(2,"ion-icon",23),e.k0s())}function y(n,a){if(1&n&&e.DNE(0,S,3,0,"div",13),2&n){const o=e.XpG(2).$implicit;e.Y8G("ngIf","seen"===o.status)}}function F(n,a){if(1&n&&(e.j41(0,"div",19),e.DNE(1,w,3,0,"div",20)(2,k,1,2,"ng-template",null,2,e.C5r)(4,y,1,1,"ng-template",null,3,e.C5r),e.k0s()),2&n){const o=e.sdS(3),t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf","pending"===t.status)("ngIfElse",o)}}function N(n,a){if(1&n&&(e.j41(0,"div",14)(1,"div",15)(2,"div",16)(3,"p"),e.EFF(4),e.k0s()(),e.j41(5,"div",17)(6,"p"),e.EFF(7),e.k0s()()(),e.DNE(8,F,6,2,"div",18),e.k0s()),2&n){const o=a.$implicit;e.AVh("right",!0===o.userIsSender),e.R7$(4),e.SpI(" ",o.senderFullName,""),e.R7$(3),e.JRh(o.message),e.R7$(),e.Y8G("ngIf",o.userIsSender)}}function G(n,a){if(1&n){const o=e.RV6();e.j41(0,"ion-button",24),e.bIt("click",function(){e.eBV(o);const i=e.XpG();return e.Njj(i.sendMessage())}),e.nrm(1,"ion-icon",25),e.k0s()}}function E(n,a){1&n&&e.nrm(0,"ion-spinner")}const R=[{path:"",component:(()=>{var n;class a{constructor(t,i,s,r,l){this.navCtrl=t,this.conversationMessagesService=i,this.activatedRoute=s,this.loadingController=r,this.appService=l,this.messages=[],this.conversationId="",this.receiverFullName="",this.isCalled=!1,this.listenToSocketUpdateListMessagesEvent()}ngOnInit(){var t=this;return(0,M.A)(function*(){yield(yield t.loadingController.create({spinner:"bubbles",cssClass:"custom-loader-class",showBackdrop:!1})).present(),yield t.loadingController.dismiss(),t.getConversationMessages(),t.conversationMessagesService.generateSessionId().subscribe(s=>{s.session_id&&t.appService.setSessionId(s.session_id)},s=>{console.log("caught error {}",s),t.isCalled=!1})})()}onFocus(){this.messageInput&&this.messageInput.nativeElement&&this.messageInput.nativeElement.focus()}getConversationMessages(t){const i=this.appService.getUserObj(),s=new P;s._id="2",s.username="driod@gmail.com",s.firstName="receiver first",s.lastName="receiver last",s.password="driod@gmail.com";const r=i;r._id="1";const d=s;(this.receiverFullName=d.firstName+" "+d.lastName,this.receiverId=d._id,r)&&(t&&("string"==typeof r?this.conversationId=r:(this.pushNewMessage({message:t.response,sender:d,session_id:"710ec67d-4ee1-4179-a97a-02022210fde4",receivers:[{receiverId:this.receiverId,isRead:!0}],receiversIds:[this.receiverId],userIsSender:!1,createdAt:new Date}),this.messages=this.messages.map(z=>this.filterMessageAndUpdateStatus(z,r)),this.scrollToBottom())))}filterMessageAndUpdateStatus(t,i){return t.senderFullName=t.sender.firstName+" "+t.sender.lastName,t.sender._id===i.id&&(t.userIsSender=!0),t.receivers.forEach(s=>{t.userIsSender&&(t.status=s.isRead?"seen":"sent")}),t}sendMessage(){var t,i;if(null===(t=this.editorMsg)||void 0===t||!t.trim())return;this.isCalled=!0;const s={message:this.editorMsg,session_id:null!==(i=this.appService.getSessionId())&&void 0!==i?i:"",db_folder:"health_supplements",receiversIds:[this.receiverId],userIsSender:!0,createdAt:new Date};this.editorMsg="",this.onFocus(),this.pushNewMessage(s),this.conversationMessagesService.sendMessage(s).subscribe(r=>{this.isCalled=!1,this.messages.forEach(l=>{l.message===s.message&&l.userIsSender&&(l.status="sent")}),this.getConversationMessages(r)},r=>{console.log("caught error {}",r),this.isCalled=!1})}listenToSocketUpdateListMessagesEvent(){this.getConversationMessages(),this.scrollToBottom()}scrollToBottom(){setTimeout(()=>{this.content.scrollToBottom&&this.content.scrollToBottom()},200)}pushNewMessage(t){t.status="pending",this.messages.push(t),this.scrollToBottom()}ngOnDestroy(){console.log("Getting destroyed the message component!!!")}}return(n=a).\u0275fac=function(t){return new(t||n)(e.rXU(C.q9),e.rXU(b.j),e.rXU(u.nX),e.rXU(g.Xi),e.rXU(O.d))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-tab3"]],viewQuery:function(t,i){if(1&t&&(e.GBs(T,7),e.GBs(I,7)),2&t){let s;e.mGM(s=e.lsd())&&(i.content=s.first),e.mGM(s=e.lsd())&&(i.messageInput=s.first)}},standalone:!1,decls:15,vars:5,consts:[["content",""],["chatInput",""],["sent",""],["seen",""],[3,"translucent"],[1,"three-d-title"],["id","content",1,"ion-padding"],[1,"message-wrap"],["class","message",3,"right",4,"ngFor","ngForOf"],["id","bottom"],["lines","none"],["clearInput","true","placeholder","Type something here",3,"ngModelChange","focusin","ngModel"],["size","large","slot","end","fill","outline",3,"click",4,"ngIf"],[4,"ngIf"],[1,"message"],[1,"msg-detail"],[1,"msg-info"],[1,"msg-content"],["class","msg-status",4,"ngIf"],[1,"msg-status"],[4,"ngIf","ngIfElse"],["name","checkmark-circle"],["name","checkmark-circle-outline"],["name","checkmark"],["size","large","slot","end","fill","outline",3,"click"],["name","send-outline","slot","icon-only"]],template:function(t,i){if(1&t){const s=e.RV6();e.j41(0,"ion-header",4)(1,"ion-toolbar")(2,"ion-title",5),e.EFF(3," LawAIr, Your Legal Advisor "),e.k0s()()(),e.j41(4,"ion-content",6,0)(6,"div",7),e.DNE(7,N,9,5,"div",8),e.k0s(),e.nrm(8,"div",9),e.k0s(),e.j41(9,"ion-footer")(10,"ion-item",10)(11,"ion-textarea",11,1),e.mxI("ngModelChange",function(l){return e.eBV(s),e.DH7(i.editorMsg,l)||(i.editorMsg=l),e.Njj(l)}),e.bIt("focusin",function(){return e.eBV(s),e.Njj(i.onFocus())}),e.k0s(),e.DNE(13,G,2,0,"ion-button",12)(14,E,1,0,"ion-spinner",13),e.k0s()()}2&t&&(e.Y8G("translucent",!0),e.R7$(7),e.Y8G("ngForOf",i.messages),e.R7$(4),e.R50("ngModel",i.editorMsg),e.R7$(2),e.Y8G("ngIf",!1===i.isCalled),e.R7$(),e.Y8G("ngIf",!0===i.isCalled))},dependencies:[g.Jm,g.W9,g.M0,g.eU,g.iq,g.uz,g.w2,g.nc,g.BC,g.ai,g.Gw,m.Sq,m.bT,p.BC,p.vS],styles:[".three-d-title[_ngcontent-%COMP%]{font-size:18px;color:#333;line-height:1.6;font-weight:500;padding:15px;background:#0000000d;border-left:4px solid black;border-right:4px solid black;box-shadow:inset 3px 3px 5px #0000001a;transition:all .3s ease}ion-content[_ngcontent-%COMP%]   .scroll-content[_ngcontent-%COMP%]{background-color:#f5f5f5}ion-footer[_ngcontent-%COMP%]   .send-button[_ngcontent-%COMP%]{position:relative;--padding-end: 0;--padding-start: 0;--background-activated: rgba(0, 0, 0, 0);--background-focused: rgba(0, 0, 0, 0);--background-hover: rgba(0, 0, 0, 0)}ion-footer[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-custom)}.header[_ngcontent-%COMP%]{height:45%;background:var(--ion-color-primary)}ion-card[_ngcontent-%COMP%]{bottom:50px;width:80%;height:40%;--background: white;left:7.5%}.sign-up[_ngcontent-%COMP%]{color:var(--ion-color-medium);position:relative}.sign-up[_ngcontent-%COMP%]   .link[_ngcontent-%COMP%]{color:#d42d0f}.message-wrap[_ngcontent-%COMP%]{padding:0 10px}.message-wrap[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{min-height:100%;position:relative;padding:7px 0}.message-wrap[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .msg-detail[_ngcontent-%COMP%]{width:100%;display:inline-block}.message-wrap[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .msg-detail[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.message-wrap[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .msg-detail[_ngcontent-%COMP%]   .msg-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-transform:capitalize;font-size:.8em;color:#888}.message-wrap[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .msg-detail[_ngcontent-%COMP%]   .msg-content[_ngcontent-%COMP%]{white-space:pre-wrap;position:relative;float:left;margin-top:2px;border-radius:10px;padding:10px;border:2px solid #ddd;width:auto;max-width:70%;background-color:#fff}.message-wrap[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .msg-status[_ngcontent-%COMP%]{text-transform:capitalize;font-size:.8em;font-weight:700;color:#888;padding-left:1%}.message-wrap[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .msg-status[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:relative;top:3px;font-size:15px}.message-wrap[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]{min-height:100%;position:relative;padding:7px 0}.message-wrap[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .msg-detail[_ngcontent-%COMP%]{width:100%;display:inline-block}.message-wrap[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .msg-detail[_ngcontent-%COMP%]   .msg-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:right;text-transform:capitalize;font-size:.8em;color:#888}.message-wrap[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .msg-detail[_ngcontent-%COMP%]   .msg-content[_ngcontent-%COMP%]{white-space:pre-wrap;color:#000;background-color:var(--ion-color-custom);float:right;position:relative;margin-top:2px;border-radius:10px;padding:10px;width:auto;max-width:70%}.message-wrap[_ngcontent-%COMP%]   .message.right[_ngcontent-%COMP%]   .msg-status[_ngcontent-%COMP%]{text-align:right;text-transform:capitalize;font-size:.8em;font-weight:700;color:#888;padding-right:1%}"]}),a})()}];let j=(()=>{var n;class a{}return(n=a).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[u.iI.forChild(R),u.iI]}),a})(),B=(()=>{var n;class a{}return(n=a).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[g.bv,m.MD,p.YN,v.S,j]}),a})()}}]);