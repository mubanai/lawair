{"version":3,"file":"src_app_tab3_tab3_module_ts.js","mappings":";;;;;;;;;;;;;AAAM,MAAOA,IAAI;EACfC,YACSC,GAAY,EACZC,QAAiB,EACjBC,QAAiB,EACjBC,SAAkB,EAClBC,QAAiB,EACjBC,SAAkB,EAClBC,SAAkB;IANlB,KAAAN,GAAG,GAAHA,GAAG;IACH,KAAAC,QAAQ,GAARA,QAAQ;IACR,KAAAC,QAAQ,GAARA,QAAQ;IACR,KAAAC,SAAS,GAATA,SAAS;IACT,KAAAC,QAAQ,GAARA,QAAQ;IACR,KAAAC,SAAS,GAATA,SAAS;IACT,KAAAC,SAAS,GAATA,SAAS;EACf;;;;;;;;;;;;;;;;;;;ACRkD;AAChB;;;AAEvC,MAAMG,MAAM,GAAW,CACrB;EACEC,IAAI,EAAE,EAAE;EACRC,SAAS,EAAEH,gDAAQA;CACpB,CACF;AAMK,MAAOI,qBAAqB;yBAArBA,qBAAqB;;mCAArBA,sBAAqB;AAAA;;QAArBA;AAAqB;;YAHtBL,yDAAY,CAACM,QAAQ,CAACJ,MAAM,CAAC,EAC7BF,yDAAY;AAAA;;sHAEXK,qBAAqB;IAAAE,OAAA,GAAAC,yDAAA;IAAAC,OAAA,GAFtBT,yDAAY;EAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;ACbqB;AAEE;AACF;AACN;AACyD;AAElC;;AAYxD,MAAOc,cAAc;kBAAdA,cAAc;;mCAAdA,eAAc;AAAA;;QAAdA;AAAc;;YARvBJ,uDAAW,EACXC,yDAAY,EACZC,uDAAW,EACXC,wGAA+B,EAC/BR,uEAAqB;AAAA;;sHAIZS,cAAc;IAAAC,YAAA,GAFVd,gDAAQ;IAAAM,OAAA,GANrBG,uDAAW,EACXC,yDAAY,EACZC,uDAAW,EACXC,wGAA+B,EAC/BR,uEAAqB;EAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;ACLa;;;;;;;;;;;;ICU9BW,4DAAA,UAAoD;IAClDA,oDAAA,gBACA;IAAAA,uDAAA,mBAA6C;IAC/CA,0DAAA,EAAM;;;;;IAEJA,4DAAA,UAAiD;IAC/CA,oDAAA,aACA;IAAAA,uDAAA,mBAAqD;IACvDA,0DAAA,EAAM;;;;;IAHNA,wDAAA,IAAAM,iDAAA,kBAAiD;;;;;;IAAXN,wDAAhC,SAAAQ,UAAA,CAAAC,MAAA,YAAgC,aAAAC,OAAA,CAAS;;;;;IAM/CV,4DAAA,UAAuC;IACrCA,oDAAA,aACA;IAAAA,uDAAA,mBAAsC;IACxCA,0DAAA,EAAM;;;;;IAHNA,wDAAA,IAAAW,iDAAA,kBAAuC;;;;IAAjCX,wDAAA,SAAAQ,UAAA,CAAAC,MAAA,YAA+B;;;;;IAZzCT,4DAAA,cAAqD;IAWnDA,wDAVA,IAAAY,mCAAA,kBAAoD,IAAAC,2CAAA,gCAAAb,oEAAA,CAIjC,IAAAe,2CAAA,gCAAAf,oEAAA,CAMA;IAMrBA,0DAAA,EAAM;;;;;IAhBEA,uDAAA,EAAmC;IAAAA,wDAAnC,SAAAQ,UAAA,CAAAC,MAAA,eAAmC,aAAAQ,OAAA,CAAS;;;;;IAPhDjB,4DAHN,cAAqG,cAC3E,cACA,QACjB;IAACA,oDAAA,GAA0B;IAChCA,0DADgC,EAAI,EAC9B;IAEJA,4DADF,cAAyB,QACpB;IAAAA,oDAAA,GAAmB;IAE1BA,0DAF0B,EAAI,EACtB,EACF;IACNA,wDAAA,IAAAkB,6BAAA,kBAAqD;IAkBvDlB,0DAAA,EAAM;;;;IA3BgDA,yDAAA,UAAAQ,UAAA,CAAAY,YAAA,UAA8C;IAG1FpB,uDAAA,GAA0B;IAA1BA,gEAAA,MAAAQ,UAAA,CAAAc,cAAA,KAA0B;IAG3BtB,uDAAA,GAAmB;IAAnBA,+DAAA,CAAAQ,UAAA,CAAAgB,OAAA,CAAmB;IAGpBxB,uDAAA,EAA0B;IAA1BA,wDAAA,SAAAQ,UAAA,CAAAY,YAAA,CAA0B;;;;;;IA2BlCpB,4DAAA,qBAAsG;IAA7EA,wDAAA,mBAAA0B,4DAAA;MAAA1B,2DAAA,CAAA4B,GAAA;MAAA,MAAAC,MAAA,GAAA7B,2DAAA;MAAA,OAAAA,yDAAA,CAAS6B,MAAA,CAAAG,WAAA,EAAa;IAAA,EAAC;IAC5ChC,uDAAA,mBAA0D;IAC9DA,0DAAA,EAAa;;;;;IACbA,uDAAA,kBAAsD;;;AD5BpD,MAAOf,QAAQ;EAUnBT,YACUyD,OAAsB,EACtBC,2BAAwD,EACxDC,cAA8B,EAC/BC,iBAAoC,EACpCC,UAAsB;IAJrB,KAAAJ,OAAO,GAAPA,OAAO;IACP,KAAAC,2BAA2B,GAA3BA,2BAA2B;IAC3B,KAAAC,cAAc,GAAdA,cAAc;IACf,KAAAC,iBAAiB,GAAjBA,iBAAiB;IACjB,KAAAC,UAAU,GAAVA,UAAU;IAXnB,KAAAC,QAAQ,GAAc,EAAE;IACxB,KAAAC,cAAc,GAAW,EAAE;IAC3B,KAAAC,gBAAgB,GAAW,EAAE;IAG7B,KAAAC,QAAQ,GAAY,KAAK;IAQvB,IAAI,CAACC,qCAAqC,EAAE;EAC9C;EACMC,QAAQA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,qIAAA;MACZ,MAAMC,OAAO,SAASF,KAAI,CAACR,iBAAiB,CAACW,MAAM,CAAC;QAClDC,OAAO,EAAE,SAAS;QAClBC,QAAQ,EAAE,qBAAqB;QAC/BC,YAAY,EAAE;OACf,CAAC;MACF,MAAMJ,OAAO,CAACK,OAAO,EAAE;MACvB,MAAMP,KAAI,CAACR,iBAAiB,CAACgB,OAAO,EAAE;MACtC;MACER,KAAI,CAACS,uBAAuB,EAAE;MAC9B;MACF;MACAT,KAAI,CAACV,2BAA2B,CAACoB,iBAAiB,EAAE,CAACC,SAAS,CAC3DC,GAAG,IAAI;QACN,IAAGA,GAAG,CAACC,UAAU,EAAE;UACjBb,KAAI,CAACP,UAAU,CAACqB,YAAY,CAACF,GAAG,CAACC,UAAU,CAAC;QAC9C;MACF,CAAC,EACAE,GAAG,IAAI;QACNC,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEF,GAAG,CAAC;QACnCf,KAAI,CAACH,QAAQ,GAAC,KAAK;MACrB;MACA;OACD;IAAC;EACJ;EAEAqB,OAAOA,CAAA;IACL,IAAI,IAAI,CAACC,YAAY,IAAI,IAAI,CAACA,YAAY,CAACC,aAAa,EAAE;MACxD,IAAI,CAACD,YAAY,CAACC,aAAa,CAACC,KAAK,EAAE;IACzC;EACF;EAEAZ,uBAAuBA,CAACa,MAAY;IAClC,MAAMC,eAAe,GAAG,IAAI,CAAC9B,UAAU,CAAC+B,UAAU,EAAE;IACpD,MAAMC,iBAAiB,GAAG,IAAI9F,8CAAI,EAAE;IACpC8F,iBAAiB,CAAC5F,GAAG,GAAC,GAAG;IACzB4F,iBAAiB,CAAC3F,QAAQ,GAAC,iBAAiB;IAC5C2F,iBAAiB,CAACzF,SAAS,GAAC,QAAQ;IACpCyF,iBAAiB,CAACxF,QAAQ,GAAC,EAAE;IAC7BwF,iBAAiB,CAAC1F,QAAQ,GAAC,iBAAiB;IAC5C,MAAM2F,IAAI,GAAGH,eAAe;IAC5BG,IAAI,CAAC7F,GAAG,GAAC,GAAG;IACZ,MAAM8F,WAAW,GAAG,IAAI,CAACpC,cAAc,CAACqC,QAAQ,CAACD,WAAW;IAC5D,MAAME,QAAQ,GAASJ,iBAAiB,CAAC;IACzC,IAAI,CAAC7B,gBAAgB,GAAGiC,QAAQ,CAAC7F,SAAS,GAAG,GAAG,GAAG6F,QAAQ,CAAC5F,QAAQ;IACpE+E,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;IACrB,IAAI,CAACa,UAAU,GAAGD,QAAQ,CAAChG,GAAG;IAC9B,IAAI6F,IAAI,EAAE;MAAA,IAAAK,aAAA,EAAAC,SAAA;MACR,MAAMC,YAAY,GAAa,EAAAF,aAAA,GAACF,QAAQ,CAAChG,GAAG,cAAAkG,aAAA,cAAAA,aAAA,GAAE,EAAE,GAAAC,SAAA,GAAEN,IAAI,CAAC7F,GAAG,cAAAmG,SAAA,cAAAA,SAAA,GAAE,EAAE,CAAC;MAC/D;MACA;MACA;MACA,IAAGV,MAAM,EAAE;QACP,IAAI,OAAOI,IAAI,KAAK,QAAQ,EAAE;UAC5B,IAAI,CAAC/B,cAAc,GAAG+B,IAAI;QAC5B,CAAC,MAAM;UACL,MAAM9C,OAAO,GAAY;YACvBA,OAAO,EAAE0C,MAAM,CAACY,QAAQ;YACxBC,MAAM,EAAEN,QAAQ;YAChBhB,UAAU,EAAE,sCAAsC;YAClDuB,SAAS,EAAE,CAAC;cAACN,UAAU,EAAE,IAAI,CAACA,UAAU;cAAEO,MAAM,EAAE;YAAI,CAAC,CAAC;YACxDC,YAAY,EAAE,CAAC,IAAI,CAACR,UAAU,CAAC;YAC/BtD,YAAY,EAAE,KAAK;YACnBtC,SAAS,EAAE,IAAIqG,IAAI;WACpB;UACD,IAAI,CAACC,cAAc,CAAC5D,OAAO,CAAC;UAC5B,IAAI,CAACc,QAAQ,GAAG,IAAI,CAACA,QAAQ,CAAC+C,GAAG,CAAE7D,OAAO,IAAI;YAC5C,OAAO,IAAI,CAAC8D,4BAA4B,CAAC9D,OAAO,EAAE8C,IAAI,CAAC;UACzD,CAAC,CAAC;UACF,IAAI,CAACiB,cAAc,EAAE;QACvB;MACF;MACA;IACJ;EACF;EAEAD,4BAA4BA,CAAC9D,OAAgB,EAAE8C,IAAS;IAAA,IAAAkB,IAAA,EAAAC,qBAAA,EAAAC,eAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,kBAAA;IACtDrE,OAAO,CAACF,cAAc,IAAAkE,IAAA,IAAAC,qBAAA,IAAAC,eAAA,GACpBlE,OAAO,CAACuD,MAAM,cAAAW,eAAA,uBAAdA,eAAA,CAAgB9G,SAAS,cAAA6G,qBAAA,cAAAA,qBAAA,GAAE,EAAE,GAAG,GAAG,KAAAE,gBAAA,GAAGnE,OAAO,CAACuD,MAAM,cAAAY,gBAAA,uBAAdA,gBAAA,CAAgB9G,QAAQ,eAAA2G,IAAA,cAAAA,IAAA,GAAE,EAAE;IACpE,IAAI,EAAAI,gBAAA,GAAApE,OAAO,CAACuD,MAAM,cAAAa,gBAAA,uBAAdA,gBAAA,CAAgBnH,GAAG,OAAK6F,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEwB,EAAE,GAAE;MACpCtE,OAAO,CAACJ,YAAY,GAAG,IAAI;IAC7B;IACA,CAAAyE,kBAAA,GAAArE,OAAO,CAACwD,SAAS,cAAAa,kBAAA,eAAjBA,kBAAA,CAAmBE,OAAO,CAAEtB,QAAQ,IAAI;MACtC,IAAIjD,OAAO,CAACJ,YAAY,EAAE;QACxB,IAAIqD,QAAQ,CAACQ,MAAM,EAAE;UACnBzD,OAAO,CAACf,MAAM,GAAG,MAAM;QACzB,CAAC,MAAM;UACLe,OAAO,CAACf,MAAM,GAAG,MAAM;QACzB;MACF;IACF,CAAC,CAAC;IACF,OAAOe,OAAO;EAChB;EAEAQ,WAAWA,CAAA;IAAA,IAAAgE,eAAA,EAAAC,qBAAA;IACT,IAAI,GAAAD,eAAA,GAAC,IAAI,CAACE,SAAS,cAAAF,eAAA,eAAdA,eAAA,CAAgBG,IAAI,EAAE,GAAE;MAC3B;IACF;IACA,IAAI,CAAC1D,QAAQ,GAAG,IAAI;IACpB,MAAMjB,OAAO,GAAY;MACvBA,OAAO,EAAE,IAAI,CAAC0E,SAAS;MACvBzC,UAAU,GAAAwC,qBAAA,GAAE,IAAI,CAAC5D,UAAU,CAAC+D,YAAY,EAAE,cAAAH,qBAAA,cAAAA,qBAAA,GAAE,EAAE;MAC9CI,SAAS,EAAE,oBAAoB;MAC/BnB,YAAY,EAAE,CAAC,IAAI,CAACR,UAAU,CAAC;MAC/BtD,YAAY,EAAE,IAAI;MAClBtC,SAAS,EAAE,IAAIqG,IAAI;KACpB;IACD,IAAI,CAACe,SAAS,GAAG,EAAE;IACnB,IAAI,CAACpC,OAAO,EAAE;IACd,IAAI,CAACsB,cAAc,CAAC5D,OAAO,CAAC;IAC5B,IAAI,CAACU,2BAA2B,CAACF,WAAW,CAACR,OAAO,CAAC,CAAC+B,SAAS,CAC5DC,GAAG,IAAI;MACN,IAAI,CAACf,QAAQ,GAAC,KAAK;MACnB,IAAI,CAACH,QAAQ,CAACyD,OAAO,CAAEO,OAAO,IAAI;QAChC,IAAIA,OAAO,CAAC9E,OAAO,KAAKA,OAAO,CAACA,OAAO,IAAI8E,OAAO,CAAClF,YAAY,EAAE;UAC/DkF,OAAO,CAAC7F,MAAM,GAAG,MAAM;QACzB;MACF,CAAC,CAAC;MACF,IAAI,CAAC4C,uBAAuB,CAACG,GAAG,CAAC;IACnC,CAAC,EACAG,GAAG,IAAI;MACNC,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEF,GAAG,CAAC;MACnC,IAAI,CAAClB,QAAQ,GAAC,KAAK;IACrB;IACA;KACD;EACH;EAEAC,qCAAqCA,CAAA;IACnC;IACE,IAAI,CAACW,uBAAuB,EAAE;IAC9B,IAAI,CAACkC,cAAc,EAAE;IACvB;EACF;EAEAA,cAAcA,CAAA;IACZgB,UAAU,CAAC,MAAK;MACd,IAAI,IAAI,CAACC,OAAO,CAACjB,cAAc,EAAE;QAC/B,IAAI,CAACiB,OAAO,CAACjB,cAAc,EAAE;MAC/B;IACF,CAAC,EAAE,GAAG,CAAC;EACT;EACAH,cAAcA,CAAC5D,OAAgB;IAC7BA,OAAO,CAACf,MAAM,GAAG,SAAS;IAC1B,IAAI,CAAC6B,QAAQ,CAACmE,IAAI,CAACjF,OAAO,CAAC;IAC3B,IAAI,CAAC+D,cAAc,EAAE;EACvB;EAEAmB,WAAWA,CAAA;IACT9C,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC;EAC3D;;YAzKW5E,QAAQ;;mCAARA,SAAQ,EAAAe,+DAAA,CAAAR,yDAAA,GAAAQ,+DAAA,CAAA6G,gGAAA,GAAA7G,+DAAA,CAAA+G,2DAAA,GAAA/G,+DAAA,CAAAR,6DAAA,GAAAQ,+DAAA,CAAAkH,6DAAA;AAAA;;QAARjI,SAAQ;EAAAmI,SAAA;EAAAC,SAAA,WAAAC,eAAAC,EAAA,EAAAC,GAAA;IAAA,IAAAD,EAAA;;;;;;;;;;;;;;;;;MCnBjBvH,4DAFJ,oBAAiC,kBAClB,mBACsB;MAC/BA,oDAAA,mCACF;MAEJA,0DAFI,EAAY,EACA,EACH;MAGXA,4DADF,wBAAuD,aAC3B;MACxBA,wDAAA,IAAAyH,uBAAA,iBAAqG;MA4BvGzH,0DAAA,EAAM;MACNA,uDAAA,aAAuB;MACzBA,0DAAA,EAAc;MAIVA,4DAFJ,iBAAY,oBACa,2BACoG;MAAhGA,8DAAA,2BAAA2H,yDAAAC,MAAA;QAAA5H,2DAAA,CAAA6H,GAAA;QAAA7H,gEAAA,CAAAwH,GAAA,CAAAtB,SAAA,EAAA0B,MAAA,MAAAJ,GAAA,CAAAtB,SAAA,GAAA0B,MAAA;QAAA,OAAA5H,yDAAA,CAAA4H,MAAA;MAAA,EAAuB;MAAC5H,wDAAA,qBAAA+H,mDAAA;QAAA/H,2DAAA,CAAA6H,GAAA;QAAA,OAAA7H,yDAAA,CAAWwH,GAAA,CAAA1D,OAAA,EAAS;MAAA,EAAC;MACtE9D,0DAAA,EAAe;MAIfA,wDAHA,KAAAgI,+BAAA,yBAAsG,KAAAC,gCAAA,0BAG9D;MAE5CjI,0DADE,EAAW,EACA;;;MAnDDA,wDAAA,qBAAoB;MAUHA,uDAAA,GAAW;MAAXA,wDAAA,YAAAwH,GAAA,CAAAlF,QAAA,CAAW;MAkCXtC,uDAAA,GAAuB;MAAvBA,8DAAA,YAAAwH,GAAA,CAAAtB,SAAA,CAAuB;MAE4BlG,uDAAA,GAAwB;MAAxBA,wDAAA,SAAAwH,GAAA,CAAA/E,QAAA,WAAwB;MAGtFzC,uDAAA,EAAuB;MAAvBA,wDAAA,SAAAwH,GAAA,CAAA/E,QAAA,UAAuB","sources":["./src/app/models/user.ts","./src/app/tab3/tab3-routing.module.ts","./src/app/tab3/tab3.module.ts","./src/app/tab3/tab3.page.ts","./src/app/tab3/tab3.page.html"],"sourcesContent":["export class User {\n  constructor(\n    public _id?: string,\n    public username?: string,\n    public password?: string,\n    public firstName?: string,\n    public lastName?: string,\n    public createdAt?: string,\n    public updatedAt?: string\n  ) {}\n}\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { Tab3Page } from './tab3.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: Tab3Page,\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class Tab3PageRoutingModule {}\r\n","import { IonicModule } from '@ionic/angular';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Tab3Page } from './tab3.page';\r\nimport { ExploreContainerComponentModule } from '../explore-container/explore-container.module';\r\n\r\nimport { Tab3PageRoutingModule } from './tab3-routing.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    IonicModule,\r\n    CommonModule,\r\n    FormsModule,\r\n    ExploreContainerComponentModule,\r\n    Tab3PageRoutingModule\r\n  ],\r\n  declarations: [Tab3Page]\r\n})\r\nexport class Tab3PageModule {}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  ViewChild,\r\n  ElementRef,\r\n  OnDestroy,\r\n} from '@angular/core';\r\n\r\nimport { ConversationMessagesService } from '../services/conversation-messages.service';\r\nimport { LoadingController, NavController } from '@ionic/angular';\r\nimport { User } from '../models/user';\r\nimport { Message } from '../models/message';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { AppService } from '../services/app.service';\r\n@Component({\r\n  selector: 'app-tab3',\r\n  templateUrl: 'tab3.page.html',\r\n  styleUrls: ['tab3.page.scss'],\r\n  standalone: false,\r\n})\r\n\r\nexport class Tab3Page implements OnInit, OnDestroy {\r\n\r\n  @ViewChild('content', { static: true }) private content: any;\r\n  @ViewChild('chatInput', { static: true }) messageInput: ElementRef | undefined;\r\n  messages: Message[] = [];\r\n  conversationId: string = '';\r\n  receiverFullName: string = '';\r\n  editorMsg: any;\r\n  receiverId: any;\r\n  isCalled: boolean = false;\r\n  constructor(\r\n    private navCtrl: NavController,\r\n    private conversationMessagesService: ConversationMessagesService,\r\n    private activatedRoute: ActivatedRoute,\r\n    public loadingController: LoadingController,\r\n    public appService: AppService\r\n  ) {\r\n    this.listenToSocketUpdateListMessagesEvent();\r\n  }\r\n  async ngOnInit() {\r\n    const loading = await this.loadingController.create({\r\n      spinner: 'bubbles',\r\n      cssClass: 'custom-loader-class',\r\n      showBackdrop: false,\r\n    });\r\n    await loading.present();\r\n    await this.loadingController.dismiss();\r\n    // this.socket.on('connect', () => {\r\n      this.getConversationMessages();\r\n      // this.socket.emit('conversationRoomNumber', this.conversationId);\r\n    // });\r\n    this.conversationMessagesService.generateSessionId().subscribe(\r\n      (res) => {\r\n        if(res.session_id) {\r\n          this.appService.setSessionId(res.session_id);\r\n        }\r\n      },\r\n      (err) => {\r\n        console.log(\"caught error {}\", err)\r\n        this.isCalled=false;\r\n      }\r\n      // err => this.purchaseMessageProvider.storeRequest(message),\r\n    );\r\n  }\r\n\r\n  onFocus() {\r\n    if (this.messageInput && this.messageInput.nativeElement) {\r\n      this.messageInput.nativeElement.focus();\r\n    }\r\n  }\r\n\r\n  getConversationMessages(resObj?: any) {\r\n    const dummyUserSender = this.appService.getUserObj();\r\n    const dummyUserReceiver = new User();\r\n    dummyUserReceiver._id=\"2\";\r\n    dummyUserReceiver.username=\"driod@gmail.com\";\r\n    dummyUserReceiver.firstName=\"LawAir\";\r\n    dummyUserReceiver.lastName=\"\";\r\n    dummyUserReceiver.password=\"driod@gmail.com\";\r\n    const user = dummyUserSender;\r\n    user._id=\"1\"\r\n    const queryParams = this.activatedRoute.snapshot.queryParams;\r\n    const receiver: User = dummyUserReceiver;//JSON.parse(queryParams['receiver']);\r\n    this.receiverFullName = receiver.firstName + ' ' + receiver.lastName;\r\n    console.log('----->');\r\n    this.receiverId = receiver._id;\r\n    if (user) {\r\n      const participants: string[] = [receiver._id??'', user._id??''];\r\n      // this.conversationMessagesService\r\n      //   .getConversationMessages(participants)\r\n      //   .subscribe((res) => {\r\n      if(resObj) {\r\n          if (typeof user === 'string') {\r\n            this.conversationId = user;\r\n          } else {\r\n            const message: Message = {\r\n              message: resObj.response,\r\n              sender: receiver,\r\n              session_id: '710ec67d-4ee1-4179-a97a-02022210fde4',\r\n              receivers: [{receiverId: this.receiverId, isRead: true}],\r\n              receiversIds: [this.receiverId],\r\n              userIsSender: false,\r\n              createdAt: new Date(),\r\n            };\r\n            this.pushNewMessage(message);\r\n            this.messages = this.messages.map((message) => {\r\n              return this.filterMessageAndUpdateStatus(message, user);\r\n            });\r\n            this.scrollToBottom();\r\n          }\r\n        }\r\n        // });\r\n    }\r\n  }\r\n\r\n  filterMessageAndUpdateStatus(message: Message, user: any): Message {\r\n    message.senderFullName =\r\n      message.sender?.firstName??'' + ' ' + message.sender?.lastName??'';\r\n    if (message.sender?._id === user?.id) {\r\n      message.userIsSender = true;\r\n    }\r\n    message.receivers?.forEach((receiver) => {\r\n      if (message.userIsSender) {\r\n        if (receiver.isRead) {\r\n          message.status = 'seen';\r\n        } else {\r\n          message.status = 'sent';\r\n        }\r\n      }\r\n    });\r\n    return message;\r\n  }\r\n\r\n  sendMessage() {\r\n    if (!this.editorMsg?.trim()) {\r\n      return;\r\n    }\r\n    this.isCalled = true;\r\n    const message: Message = {\r\n      message: this.editorMsg,\r\n      session_id: this.appService.getSessionId()??'',\r\n      db_folder: 'health_supplements',\r\n      receiversIds: [this.receiverId],\r\n      userIsSender: true,\r\n      createdAt: new Date(),\r\n    };\r\n    this.editorMsg = '';\r\n    this.onFocus();\r\n    this.pushNewMessage(message);\r\n    this.conversationMessagesService.sendMessage(message).subscribe(\r\n      (res) => {\r\n        this.isCalled=false;\r\n        this.messages.forEach((element) => {\r\n          if (element.message === message.message && element.userIsSender) {\r\n            element.status = 'sent';\r\n          }\r\n        });\r\n        this.getConversationMessages(res);\r\n      },\r\n      (err) => {\r\n        console.log(\"caught error {}\", err)\r\n        this.isCalled=false;\r\n      }\r\n      // err => this.purchaseMessageProvider.storeRequest(message),\r\n    );\r\n  }\r\n\r\n  listenToSocketUpdateListMessagesEvent() {\r\n    // this.socket.on('new-message', () => {\r\n      this.getConversationMessages();\r\n      this.scrollToBottom();\r\n    // });\r\n  }\r\n\r\n  scrollToBottom() {\r\n    setTimeout(() => {\r\n      if (this.content.scrollToBottom) {\r\n        this.content.scrollToBottom();\r\n      }\r\n    }, 200);\r\n  }\r\n  pushNewMessage(message: Message) {\r\n    message.status = 'pending';\r\n    this.messages.push(message);\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    console.log(\"Getting destroyed the message component!!!\");\r\n  }\r\n}\r\n\r\n","<ion-header [translucent]=\"true\">\r\n  <ion-toolbar>\r\n    <ion-title class=\"three-d-title\">\r\n      LawAIr, Your Legal Advisor\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content #content id=\"content\" class=\"ion-padding\">\r\n  <div class=\"message-wrap\">\r\n    <div *ngFor=\"let message of messages\" class=\"message\" [class.right]=\" message.userIsSender === true\">\r\n      <div class=\"msg-detail\">\r\n        <div class=\"msg-info\">\r\n          <p> {{message.senderFullName}}</p>\r\n        </div>\r\n        <div class=\"msg-content\">\r\n          <p>{{message.message}}</p>\r\n        </div>\r\n      </div>\r\n      <div *ngIf=\"message.userIsSender\" class=\"msg-status\">\r\n        <div *ngIf=\"message.status === 'pending';else sent\">\r\n          pending\r\n          <ion-icon name=\"checkmark-circle\"></ion-icon>\r\n        </div>\r\n        <ng-template #sent>\r\n          <div *ngIf=\"message.status === 'sent';else seen\">\r\n            sent\r\n            <ion-icon name=\"checkmark-circle-outline\"></ion-icon>\r\n          </div>\r\n        </ng-template>\r\n        <ng-template #seen>\r\n          <div *ngIf=\"message.status === 'seen'\">\r\n            seen\r\n            <ion-icon name=\"checkmark\"></ion-icon>\r\n          </div>\r\n        </ng-template>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div id=\"bottom\"></div>\r\n</ion-content>\r\n\r\n<ion-footer>\r\n  <ion-item lines=\"none\">\r\n    <ion-textarea #chatInput [(ngModel)]=\"editorMsg\" (focusin)=\"onFocus()\" clearInput=true placeholder=\"Type something here\">\r\n    </ion-textarea>\r\n    <ion-button size=\"large\" (click)='sendMessage()' slot=\"end\" fill=\"outline\" *ngIf=\"isCalled === false\">\r\n        <ion-icon name=\"send-outline\" slot=\"icon-only\"></ion-icon>\r\n    </ion-button>\r\n    <ion-spinner *ngIf=\"isCalled === true\" ></ion-spinner>\r\n  </ion-item>\r\n</ion-footer>\r\n"],"names":["User","constructor","_id","username","password","firstName","lastName","createdAt","updatedAt","RouterModule","Tab3Page","routes","path","component","Tab3PageRoutingModule","forChild","imports","i1","exports","IonicModule","CommonModule","FormsModule","ExploreContainerComponentModule","Tab3PageModule","declarations","i0","ɵɵelementStart","ɵɵtext","ɵɵelement","ɵɵelementEnd","ɵɵtemplate","Tab3Page_div_7_div_8_ng_template_2_div_0_Template","ɵɵproperty","message_r3","status","seen_r2","Tab3Page_div_7_div_8_ng_template_4_div_0_Template","Tab3Page_div_7_div_8_div_1_Template","Tab3Page_div_7_div_8_ng_template_2_Template","ɵɵtemplateRefExtractor","Tab3Page_div_7_div_8_ng_template_4_Template","ɵɵadvance","sent_r4","Tab3Page_div_7_div_8_Template","ɵɵclassProp","userIsSender","ɵɵtextInterpolate1","senderFullName","ɵɵtextInterpolate","message","ɵɵlistener","Tab3Page_ion_button_13_Template_ion_button_click_0_listener","ɵɵrestoreView","_r5","ctx_r5","ɵɵnextContext","ɵɵresetView","sendMessage","navCtrl","conversationMessagesService","activatedRoute","loadingController","appService","messages","conversationId","receiverFullName","isCalled","listenToSocketUpdateListMessagesEvent","ngOnInit","_this","_asyncToGenerator","loading","create","spinner","cssClass","showBackdrop","present","dismiss","getConversationMessages","generateSessionId","subscribe","res","session_id","setSessionId","err","console","log","onFocus","messageInput","nativeElement","focus","resObj","dummyUserSender","getUserObj","dummyUserReceiver","user","queryParams","snapshot","receiver","receiverId","_receiver$_id","_user$_id","participants","response","sender","receivers","isRead","receiversIds","Date","pushNewMessage","map","filterMessageAndUpdateStatus","scrollToBottom","_ref","_message$sender$first","_message$sender","_message$sender2","_message$sender3","_message$receivers","id","forEach","_this$editorMsg","_this$appService$getS","editorMsg","trim","getSessionId","db_folder","element","setTimeout","content","push","ngOnDestroy","ɵɵdirectiveInject","NavController","i2","ConversationMessagesService","i3","ActivatedRoute","LoadingController","i4","AppService","selectors","viewQuery","Tab3Page_Query","rf","ctx","Tab3Page_div_7_Template","ɵɵtwoWayListener","Tab3Page_Template_ion_textarea_ngModelChange_11_listener","$event","_r1","ɵɵtwoWayBindingSet","Tab3Page_Template_ion_textarea_focusin_11_listener","Tab3Page_ion_button_13_Template","Tab3Page_ion_spinner_14_Template","ɵɵtwoWayProperty"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}